<div class="container min-h-screen flex flex-row h-screen bg-base-200">

  <!-- sidebar -->
  <div class="w-1/4 bg-base-200 flex flex-col gap-4 overflow-y-auto">
    <div class="flex flex-col gap-4 justify-content items-center pt-2 pb-2 pl-2 pr-2">

      <!-- NGFOR HERE -->
      <!-- CONTACTS -->
      <input #contactInput type="text" id="addContact" name="search" placeholder="Add Contact" class="py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
      <button type="submit" class="btn btn-primary" (click)="addContact(contactInput.value)">Add</button>

      <ng-container *ngFor="let contact of contacts">
        <div class="rounded-box card card-side w-11/12 hover:brightness-90"
              [class.bg-gray-300]="selectedContact === contact"
              [class.bg-gray-100]="selectedContact !== contact"
              (click)="selectContact(contact)">
          <div class="flex items-center gap-4 p-4">
            <img class="w-12 h-12 rounded-full" [src]="contact.userImage">
            <div class="flex flex-col">
              <strong>{{contact.userFirstName}} {{contact.userLastName}}</strong>
              <span>
                <p>{{ contact.userBiography | slice:0:20 }}</p>
              </span>
            </div>
          </div>
        </div>
      </ng-container>

    </div>
  </div>



  <!-- main content -->
  <div class="w-3/4 h-full bg-white flex flex-col justify-between">

    <!-- TOP BAR -->
    <div class="top-bar bg-white p-4 flex justify-end items-center">

      <div *ngIf="selectedContact" class="w-1/3 flex flex-row items-center">

        <div class="flex items-center gap-4 p-4">

          <img class="w-12 h-12 rounded-full" [src]="selectedContact.userImage">

          <div class="flex flex-col">
            <strong>{{selectedContact.userFirstName}} {{selectedContact.userLastName}}</strong>
            <span>
              <p>{{ selectedContact.userBiography | slice:0:20 }}</p>
            </span>
          </div>

        </div>

      </div>

      <div *ngIf="selectedContact" class="w-2/3 flex justify-end items-center">

        <div class="flex space-x-4">

          <input type="text" id="search" name="search" placeholder="Search..." class="py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
          <button type="submit" class="btn btn-primary">Search</button>

        </div>

      </div>

    </div>

    <div class="overflow-auto h-3/4 w-11/12 chat-log" style="margin-left: auto; margin-right: auto;" #chatLog>
      <div *ngFor="let message of selectedConversation" class="container h-full w-full flex flex-col px-6 py-2"
           [class.chat-end]="message.senderId == this.messengerService.demoPrimaryUserId"
           [class.chat-start]="message.senderId != this.messengerService.demoPrimaryUserId">
        <div class="chat-header">
          {{ message.senderId == this.messengerService.demoPrimaryUserId ? 'Me' : selectedContact?.userFirstName + ' ' + selectedContact?.userLastName }}
        </div>
        <div class="chat-bubble bg-base-300 text-black">{{ message.messageContent }}</div>
        <div class="chat-footer opacity-50">
          Seen
        </div>
      </div>
    </div>

    <div *ngIf="selectedContact" class="container w-full flex flex-row px-6 py-2">
      <input [(ngModel)]="newMessage" class="py-2 px-3 w-11/12 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Type your message here...">
      <button (click)="sendMessage()" class="btn btn-primary">Send</button>
    </div>

  </div>

 </div>

