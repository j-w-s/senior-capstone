<div class="w-full h-1/8 bg-white flex flex-row justify-between">
  <div class="bg-white p-4">
    <h2 class="text-left">Groups</h2>
  </div>
</div>

<div class="flex flex-col h-screen">
  <div class="mx-auto my-auto w-3/4 h-3/4 bg-base-200" *ngIf="!selectedGroup && !this.creatingGroup">
      <div class="carousel-vertical flex-grow overflow-auto">
          <div class="flex flex-wrap">
              <!-- Card for creating a new group -->
              <div class="card card-compact w-full bg-base-100 shadow-xl m-4" (click)="gotoCreateGroup()">
                  <div class="card-body p-4">
                      <h2 class="card-title text-lg">Click Here To Create a NEW Group!!</h2>
                      <p class="text-sm">Design a new group here</p>
                  </div>
              </div>

              <div class="divider w-full shadow-xl m-4">Manage Your Existing Groups Below</div>

              <!-- Cards for existing groups -->
              <div class="card card-compact w-[300px] bg-base-100 shadow-xl m-4" *ngFor="let group of groups" (click)="selectGroup(group)">
                  <div class="card-body p-4">
                      <h2 class="card-title text-lg">{{ group.name }}</h2>
                      <p class="text-sm">{{ group.description }}</p>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <!-- Viewing a group section -->
  <section class="group-info mx-auto my-auto w-3/4 h-3/4 bg-gray-300" *ngIf="selectedGroup">
      <!-- Header for the group -->
      <div class="relative bg-white p-4 flex items-center">
          <button class="btn absolute left-0 m-4" (click)="goBack()">Back</button>
          <h2 class="text-center w-full">{{ selectedGroup.name }}</h2>
      </div>

      <div class="flex flex-row space-x-72" >
          <!-- Display selected group info here -->
          <div class="m-4 rounded">
              <!-- Group Name Display-->
              <label class="form-control w-full max-w-xs">
                  <div class="label">
                  <span class="label-text">Group Name</span>
                  </div>
                  <input [(ngModel)]="selectedGroup.name" type="text" class="input input-bordered w-full max-w-xs" />
              </label>
              <br>

              <!-- Group Description Display -->
              <label class="form-control w-full max-w-xs">
                  <div class="label">
                  <span class="label-text">Group Description</span>
                  </div>
                  <textarea [(ngModel)]="selectedGroup.description" class="textarea textarea-bordered" ></textarea>
              </label>
              <br>

              <!-- Group Location Display -->
              <label class="form-control w-full max-w-xs">
                  <div class="flex flex-row label">
                      <span class="label-text">Group City</span>
                      <span class="label-text">Group State</span>
                  </div>
                  <div class="flex flex-row">
                      <input [(ngModel)]="selectedGroup.city" type="text" class="input input-bordered w-full max-w-xs" />
                      <input [(ngModel)]="selectedGroup.state" type="text" class="input input-bordered w-full max-w-xs" />
                  </div>
              </label>
              <br>

              <button class="btn w-full max-w-xs" (click)="updateGroup(selectedGroup)">Update Group</button>

              
              <div class='text-right text-primary'>
                <br>
                <button class="btn w-full max-w-xs bg-red-500" onclick="deleteGroup_modal.showModal()">
                  <a>Delete Group</a>
                </button>
                <dialog id="deleteGroup_modal" class="modal modal-bottom sm:modal-middle">
                  <div class="modal-box flex items-center justify-center">
                    <div class="w-1/2 px-4">
                      <form class="flex flex-col items-center">
                        <input #deleteConfirmation type="text" placeholder="Type 'delete' to confirm delete" class="mt-4 block w-full py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        <button class="btn btn-primary w-full mt-4" (click)="deleteGroup(this.selectedGroup, deleteConfirmation.value)">Delete Group Now</button>
                      </form>
                      <button type="button" class="btn btn-base-100 w-full mt-4" onclick="deleteGroup_modal.close()">
                        Back to Group Management
                      </button>
                    </div>
                    <div class="divider lg:divider-horizontal"></div>
                    <div class="w-1/2 px-4">
                      <h2 class="font-bold text-lg" style="text-align: center;">Delete your group here</h2>
                      <p class="py-4" style="text-align: center;">Please confirm the deletion process by typing 'delete' into the text box on the left.</p>
                    </div>
                  </div>
                </dialog>
              </div>

          </div>

          <!-- Display selected group users here -->
          <div class="flex flex-col m-4">
              <label class="form-control w-full max-w-xl">
                  <div class="label">
                  <span class="label-text">Group Members</span>
                  </div>
              </label>
              <div class="carousel carousel-vertical bg-white form-control w-full max-w-xs h-[190px]">
                  <div class="carousel-item">
                      <!-- User content goes here -->

                      <div >
                          <table class="table">
                              <!-- head -->
                              <thead>
                                  <tr>
                                      <th>Name</th>
                                      <th>Username</th>
                                  </tr>
                              </thead>

                              <tbody>
                                  <!-- row 1 -->
                                  <tr *ngFor="let user of users">
                                      <td>
                                          <div class="flex items-center gap-3">
                                              <div class="avatar">
                                                  <div class="mask mask-squircle w-12 h-12">
                                                      <!-- -->
                                                      <img [src]="user.image" />  
                                                  </div>
                                              </div>
                                              <div>
                                                  <div class="font-bold">{{ user.firstname }} {{ user.lastname }}</div>
                                              </div>
                                          </div>
                                      </td>
                                      <td>
                                          {{ user.username }}
                                      </td>
                                  </tr>
        
                              </tbody>
                          
                          </table>
                      </div>


                      
                  </div>
              </div>

              

              <!-- Add User Button -->
              <label class="form-control w-full max-w-xs">
                  <br>
                  <div class="label">
                  <span class="label-text">Add User To Group</span>
                  </div>
                  <input #usernameInput placeholder="Username" type="text" class="input input-bordered w-full max-w-xs" />
                  <button class="btn" (click)="addUser(selectedGroup, usernameInput.value)">Add User</button>
                  <br>
                  <button class="btn bg-red-500" (click)="removeUser(selectedGroup, usernameInput.value)">Remove User</button>
              </label>
          
          </div>  
      
      </div>

  </section>

  <!-- Creating a group section-->
  <section class="group-info mx-auto my-auto w-3/4 h-3/4 bg-gray-300" *ngIf="this.creatingGroup">
      <!-- Header for creating group -->
      <div class="relative bg-white p-4 flex items-center">
          <button class="btn absolute left-0 m-4" (click)="goBack2()">Back</button>
          <h2 class="text-center w-full">Group Creation</h2>
      </div>

      <div class="flex flex-row justify-center" style="gap: 80px;">
          <!-- Display selected group info here -->
          <div class="m-4 rounded">
              <!-- Group Name Create-->
              <label class="form-control w-full max-w-xs">
                  <div class="label">
                  <span class="label-text">Group Name</span>
                  </div>
                  <input #groupNameInput type="text" class="input input-bordered w-full max-w-xs" />
              </label>
              <br>

              <!-- Group Description Create -->
              <label class="form-control w-full max-w-xs">
                  <div class="label">
                  <span class="label-text">Group Description</span>
                  </div>
                  <textarea #groupDescriptionInput class="textarea textarea-bordered" ></textarea>
              </label>
              <br>

              <!-- Group Location Create -->
              <label class="form-control w-full max-w-xs">
                  <div class="flex flex-row label">
                      <span class="label-text">Group City</span>
                      <span class="label-text">Group State</span>
                  </div>
                  <div class="flex flex-row">
                      <input #groupCityInput type="text" class="input input-bordered w-full max-w-xs" />
                      <input #groupStateInput type="text" class="input input-bordered w-full max-w-xs" />
                  </div>
              </label>
              <br>

              <button class="btn w-full max-w-xs" (click)="createGroup(groupNameInput.value, groupDescriptionInput.value, groupCityInput.value, groupStateInput.value)">Create Group</button>
               
          </div>
      </div>

  </section>
  
</div>
